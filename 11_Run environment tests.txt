2025-07-31T07:37:57.4787317Z ##[group]Run python test/run_all_tests.py
2025-07-31T07:37:57.4787727Z [36;1mpython test/run_all_tests.py[0m
2025-07-31T07:37:57.4823944Z shell: /usr/bin/bash -e {0}
2025-07-31T07:37:57.4824329Z env:
2025-07-31T07:37:57.4824705Z   pythonLocation: /opt/hostedtoolcache/Python/3.10.18/x64
2025-07-31T07:37:57.4825373Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.10.18/x64/lib/pkgconfig
2025-07-31T07:37:57.4826024Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-07-31T07:37:57.4826589Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-07-31T07:37:57.4827222Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-07-31T07:37:57.4827792Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.10.18/x64/lib
2025-07-31T07:37:57.4828277Z ##[endgroup]
2025-07-31T07:38:02.9157107Z None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-07-31T07:38:02.9158837Z WARNING:transformers:None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-07-31T07:38:03.2763421Z None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-07-31T07:38:03.2765299Z WARNING:transformers:None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-07-31T07:38:05.3661929Z WARNING:src.tarpit.js_zip_generator:Could not import jszip_rs: No module named 'jszip_rs'. Falling back to Python implementation.
2025-07-31T07:38:05.3691723Z WARNING:src.tarpit.markov_generator:Could not import tarpit_rs: No module named 'tarpit_rs'. Falling back to Python implementation.
2025-07-31T07:38:06.0757164Z test.admin_ui.test_admin_ui (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.0758065Z test.ai_webhook.test_ai_webhook (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.0946794Z test_push_invalid_payload (test.cloud_dashboard.test_cloud_dashboard_api.TestCloudDashboardAPI) ... ok
2025-07-31T07:38:06.1045983Z test_register_and_push_metrics (test.cloud_dashboard.test_cloud_dashboard_api.TestCloudDashboardAPI) ... ok
2025-07-31T07:38:06.1164473Z test_websocket_streams_metrics (test.cloud_dashboard.test_cloud_dashboard_api.TestCloudDashboardAPI) ... ok
2025-07-31T07:38:06.1166492Z test.escalation.test_escalation_engine (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.1168420Z test.escalation.test_extract_features (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.1170248Z test.escalation.test_fingerprint (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.1172130Z test.escalation.test_frequency_features (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.1174219Z test.escalation.test_geoip_lookup (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:06.1774644Z test_long_prompt_routes_to_cloud (test.prompt_router.test_prompt_router.TestPromptRouterRouting) ... ok
2025-07-31T07:38:06.1871628Z test_short_prompt_routes_locally (test.prompt_router.test_prompt_router.TestPromptRouterRouting) ... ok
2025-07-31T07:38:06.2066017Z test_long_prompt_goes_cloud (test.prompt_router.test_routing_behavior.TestRoutingBehavior) ... ok
2025-07-31T07:38:06.2191400Z test_short_prompt_goes_local (test.prompt_router.test_routing_behavior.TestRoutingBehavior) ... ok
2025-07-31T07:38:06.2357110Z test_get_list_empty (test.public_blocklist.test_public_blocklist_api.TestPublicBlocklistAPI) ... ok
2025-07-31T07:38:06.2477263Z test_report_ip_adds_entry (test.public_blocklist.test_public_blocklist_api.TestPublicBlocklistAPI) ... ok
2025-07-31T07:38:06.2567885Z test_report_ip_bad_key (test.public_blocklist.test_public_blocklist_api.TestPublicBlocklistAPI) ... ok
2025-07-31T07:38:06.2569015Z test_calculate_entropy (test.rag.test_email_entropy_scanner.TestEmailEntropyScannerFunctions)
2025-07-31T07:38:06.2573348Z Test Shannon entropy calculation. ... ok
2025-07-31T07:38:06.2574281Z test_is_disposable_domain (test.rag.test_email_entropy_scanner.TestEmailEntropyScannerFunctions)
2025-07-31T07:38:06.2575141Z Test disposable domain detection. ... ok
2025-07-31T07:38:06.2575927Z test_is_suspicious_email (test.rag.test_email_entropy_scanner.TestEmailEntropyScannerFunctions)
2025-07-31T07:38:06.2579124Z Test the main email suspicion function. ... ok
2025-07-31T07:38:06.2579973Z test_is_suspicious_username (test.rag.test_email_entropy_scanner.TestEmailEntropyScannerFunctions)
2025-07-31T07:38:06.2585773Z Test username suspicion logic. ... ok
2025-07-31T07:38:06.2586534Z test_main_block_runs_examples (test.rag.test_email_entropy_scanner.TestEmailEntropyScannerFunctions)
2025-07-31T07:38:06.2597315Z Test that the __main__ block executes by checking if print is called. ... ok
2025-07-31T07:38:06.2598267Z test_compute_metrics (test.rag.test_finetune.TestFinetuneScriptComprehensive)
2025-07-31T07:38:06.2644618Z Test the metrics computation for evaluation, including argmax logic. ... ok
2025-07-31T07:38:06.2645607Z test_fine_tune_model_full_flow (test.rag.test_finetune.TestFinetuneScriptComprehensive)
2025-07-31T07:38:06.2731076Z Test the main fine_tune_model function orchestrates correctly. ... ok
2025-07-31T07:38:06.2732015Z test_load_and_prepare_dataset (test.rag.test_finetune.TestFinetuneScriptComprehensive)
2025-07-31T07:38:06.2763232Z Test data loading, JSON parsing, and tokenization. ... ok
2025-07-31T07:38:06.2764081Z test_prepare_text_for_model (test.rag.test_finetune.TestFinetuneScriptComprehensive)
2025-07-31T07:38:06.2781577Z Test the text preparation function with complex log data. ... ok
2025-07-31T07:38:06.2782528Z test_assign_labels_and_scores (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.2987070Z Test the comprehensive labeling logic based on multiple factors. ... ok
2025-07-31T07:38:06.2988079Z test_load_feedback_data (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.3015500Z Test loading feedback data from honeypot and captcha logs. ... ok
2025-07-31T07:38:06.3016377Z test_load_robots_txt (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.3040287Z Test loading and parsing of the robots.txt file. ... ok
2025-07-31T07:38:06.3078293Z test_lookup_country_code (test.rag.test_training.TestTrainingPipelineComprehensive) ... ok
2025-07-31T07:38:06.3079442Z test_model_accuracy_comparison (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.7794537Z Ensure RandomForest, XGBoost, and Logistic Regression train and return accuracy. ... ok
2025-07-31T07:38:06.7795640Z test_save_data_for_finetuning (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.7833662Z Test that data is correctly formatted and saved for fine-tuning. ... ok
2025-07-31T07:38:06.7834742Z test_train_and_save_model (test.rag.test_training.TestTrainingPipelineComprehensive)
2025-07-31T07:38:06.7935000Z Test that the model training function runs, fits, and saves a model. ... ok
2025-07-31T07:38:06.8268979Z test_run_sync_loop_runs_task (test.scripts.test_blocklist_sync_daemon.TestBlocklistSyncDaemon) ... ok
2025-07-31T07:38:06.8291175Z test_missing_required (test.scripts.test_validate_env.TestValidateEnv) ... ok
2025-07-31T07:38:06.8297569Z test_model_specific_key (test.scripts.test_validate_env.TestValidateEnv) ... ok
2025-07-31T07:38:06.8302773Z test_valid_env (test.scripts.test_validate_env.TestValidateEnv) ... ok
2025-07-31T07:38:07.1382881Z test_scores_outlier_higher (test.shared.test_anomaly_detector.TestAnomalyDetector) ... ok
2025-07-31T07:38:07.1477335Z test_get_config_returns_env_overrides (test.shared.test_config_redis_client.TestGetConfig) ... ok
2025-07-31T07:38:07.1536575Z test_secret_file_exists (test.shared.test_config_redis_client.TestGetSecret) ... ok
2025-07-31T07:38:07.1553259Z test_secret_file_missing (test.shared.test_config_redis_client.TestGetSecret) ... ok
2025-07-31T07:38:10.1670394Z test_authentication_failure_returns_none (test.shared.test_config_redis_client.TestRedisClient) ... ok
2025-07-31T07:38:10.1695426Z test_missing_password_file_logs_error (test.shared.test_config_redis_client.TestRedisClient) ... ok
2025-07-31T07:38:10.1697191Z test.shared.test_decision_db (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:10.1698859Z test.shared.test_honeypot_logger (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:10.1699643Z test_get_metrics_output (test.shared.test_metrics.TestMetricsComprehensive)
2025-07-31T07:38:10.1782419Z Test that get_metrics returns the serialized data from the registry. ... ok
2025-07-31T07:38:10.1783716Z test_increment_counter_metric (test.shared.test_metrics.TestMetricsComprehensive)
2025-07-31T07:38:10.1823631Z Test the counter helper function with and without labels. ... ok
2025-07-31T07:38:10.1824292Z test_invalid_metric_type_for_helpers (test.shared.test_metrics.TestMetricsComprehensive)
2025-07-31T07:38:10.1862404Z Test that helpers raise errors for incorrect metric types. ... ok
2025-07-31T07:38:10.1863362Z test_observe_histogram_metric (test.shared.test_metrics.TestMetricsComprehensive)
2025-07-31T07:38:10.1925063Z Test the histogram observe helper function. ... ok
2025-07-31T07:38:10.1925843Z test_set_gauge_metric (test.shared.test_metrics.TestMetricsComprehensive)
2025-07-31T07:38:10.1978057Z Test the gauge set helper function with and without labels. ... ok
2025-07-31T07:38:10.1979504Z test_http_adapter_api_error (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2038526Z Test the HttpModelAdapter when the remote API returns an error status. ... ok
2025-07-31T07:38:10.2039461Z test_http_adapter_success (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2071230Z Test the HttpModelAdapter for a successful API call. ... ok
2025-07-31T07:38:10.2071901Z test_markov_adapter_success (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2079090Z Test the MarkovAdapter successfully calls the generator function. ... ok
2025-07-31T07:38:10.2079946Z test_markov_adapter_unavailable (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2084202Z Test MarkovAdapter's behavior when the generator module is not available. ... ok
2025-07-31T07:38:10.2085024Z test_sklearn_adapter_model_not_loaded (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2091774Z Test SklearnAdapter returns a default value if the model failed to load. ... ok
2025-07-31T07:38:10.2092560Z test_sklearn_adapter_success (test.shared.test_model_adapters.TestModelAdaptersComprehensive)
2025-07-31T07:38:10.2211495Z Test the SklearnAdapter with a mock model. ... ok
2025-07-31T07:38:10.2239641Z test_invalid_scheme_returns_none (test.shared.test_model_provider.TestGetModelAdapter) ... ok
2025-07-31T07:38:10.2262904Z test_retries_exhausted_returns_none (test.shared.test_model_provider.TestGetModelAdapter) ... ERROR:root:Attempt 1 failed to instantiate adapter for scheme 'sklearn': fail
2025-07-31T07:38:10.2264321Z Traceback (most recent call last):
2025-07-31T07:38:10.2270662Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/model_provider.py", line 100, in get_model_adapter
2025-07-31T07:38:10.2271524Z     return adapter_class(model_path)
2025-07-31T07:38:10.2272346Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_model_provider.py", line 24, in __init__
2025-07-31T07:38:10.2273441Z     raise ValueError("fail")
2025-07-31T07:38:10.2273796Z ValueError: fail
2025-07-31T07:38:10.2274239Z ERROR:root:Attempt 2 failed to instantiate adapter for scheme 'sklearn': fail
2025-07-31T07:38:10.2274755Z Traceback (most recent call last):
2025-07-31T07:38:10.2275573Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/model_provider.py", line 100, in get_model_adapter
2025-07-31T07:38:10.2276656Z     return adapter_class(model_path)
2025-07-31T07:38:10.2277436Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_model_provider.py", line 24, in __init__
2025-07-31T07:38:10.2278582Z     raise ValueError("fail")
2025-07-31T07:38:10.2278870Z ValueError: fail
2025-07-31T07:38:10.2279304Z ERROR:root:All 2 attempts to instantiate model adapter for scheme 'sklearn' failed.
2025-07-31T07:38:10.2279807Z ok
2025-07-31T07:38:10.2286950Z test_retry_then_success (test.shared.test_model_provider.TestGetModelAdapter) ... ERROR:root:Attempt 1 failed to instantiate adapter for scheme 'sklearn': fail
2025-07-31T07:38:10.2287572Z Traceback (most recent call last):
2025-07-31T07:38:10.2288141Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/model_provider.py", line 100, in get_model_adapter
2025-07-31T07:38:10.2288673Z     return adapter_class(model_path)
2025-07-31T07:38:10.2289206Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_model_provider.py", line 18, in __init__
2025-07-31T07:38:10.2289734Z     raise ValueError("fail")
2025-07-31T07:38:10.2289942Z ValueError: fail
2025-07-31T07:38:10.2291580Z ERROR:root:Attempt 2 failed to instantiate adapter for scheme 'sklearn': fail
2025-07-31T07:38:10.2291947Z Traceback (most recent call last):
2025-07-31T07:38:10.2292515Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/model_provider.py", line 100, in get_model_adapter
2025-07-31T07:38:10.2293192Z     return adapter_class(model_path)
2025-07-31T07:38:10.2293747Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_model_provider.py", line 18, in __init__
2025-07-31T07:38:10.2294272Z     raise ValueError("fail")
2025-07-31T07:38:10.2294474Z ValueError: fail
2025-07-31T07:38:10.2301245Z ok
2025-07-31T07:38:10.2313889Z test_returns_correct_adapter_instance (test.shared.test_model_provider.TestGetModelAdapter) ... ok
2025-07-31T07:38:10.2321023Z test_invalid_monitoring_ports (test.shared.test_validate_env.TestValidateEnvMonitoringPorts) ... ok
2025-07-31T07:38:10.2325564Z test_missing_monitoring_ports (test.shared.test_validate_env.TestValidateEnvMonitoringPorts) ... ok
2025-07-31T07:38:10.2327398Z test.tarpit (unittest.loader._FailedTest) ... ERROR
2025-07-31T07:38:10.2332009Z test_decrease_limit (test.util.test_adaptive_rate_limit.TestAdaptiveRateLimit) ... ok
2025-07-31T07:38:10.2332925Z test_empty_counts (test.util.test_adaptive_rate_limit.TestAdaptiveRateLimit) ... ok
2025-07-31T07:38:10.2334345Z test_increase_limit (test.util.test_adaptive_rate_limit.TestAdaptiveRateLimit) ... ok
2025-07-31T07:38:10.2335507Z test_keep_base (test.util.test_adaptive_rate_limit.TestAdaptiveRateLimit) ... ok
2025-07-31T07:38:10.2357097Z test_compute_and_update (test.util.test_adaptive_rate_limit_manager.TestAdaptiveRateLimitManager) ... ok
2025-07-31T07:38:10.2366718Z test_get_recent_counts (test.util.test_adaptive_rate_limit_manager.TestAdaptiveRateLimitManager) ... ok
2025-07-31T07:38:10.2370817Z test_update_rate_limit_writes_file (test.util.test_adaptive_rate_limit_manager.TestAdaptiveRateLimitManager) ... ok
2025-07-31T07:38:10.2457847Z test_fetch_blocklist_dict_format (test.util.test_community_blocklist_sync.TestCommunityBlocklistSync) ... ok
2025-07-31T07:38:10.2545421Z test_fetch_blocklist_list_format (test.util.test_community_blocklist_sync.TestCommunityBlocklistSync) ... ok
2025-07-31T07:38:10.2647179Z test_sync_blocklist_updates_redis (test.util.test_community_blocklist_sync.TestCommunityBlocklistSync) ... ok
2025-07-31T07:38:10.2656049Z test_clean_text (test.util.test_corpus_wikipedia_updater.TestWikipediaCorpusUpdater)
2025-07-31T07:38:10.2686374Z Test the text cleaning function with various markup. ... ok
2025-07-31T07:38:10.2687670Z test_fetch_random_wikipedia_articles_success (test.util.test_corpus_wikipedia_updater.TestWikipediaCorpusUpdater)
2025-07-31T07:38:10.7712220Z Test the successful fetching and processing of a valid article. ... ok
2025-07-31T07:38:10.7714087Z test_fetch_skips_disallowed_categories (test.util.test_corpus_wikipedia_updater.TestWikipediaCorpusUpdater)
2025-07-31T07:38:11.2750016Z Test that articles in disallowed categories are skipped. ... ok
2025-07-31T07:38:11.2751827Z test_fetch_skips_disambiguation_pages (test.util.test_corpus_wikipedia_updater.TestWikipediaCorpusUpdater)
2025-07-31T07:38:11.7790833Z Test that DisambiguationError is caught and the page is skipped. ... ok
2025-07-31T07:38:11.7792137Z test_update_corpus_file (test.util.test_corpus_wikipedia_updater.TestWikipediaCorpusUpdater)
2025-07-31T07:38:11.7839614Z Test that new articles are correctly appended to the corpus file. ... ok
2025-07-31T07:38:11.7921685Z test_fetch_peer_ips_dict_format (test.util.test_peer_blocklist_sync.TestPeerBlocklistSync) ... ok
2025-07-31T07:38:11.8011439Z test_fetch_peer_ips_list_format (test.util.test_peer_blocklist_sync.TestPeerBlocklistSync) ... ok
2025-07-31T07:38:11.8129424Z test_sync_peer_blocklists_updates_redis (test.util.test_peer_blocklist_sync.TestPeerBlocklistSync) ... ok
2025-07-31T07:38:11.8139129Z test_fetch_robots_txt_connection_error_returns_default (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8172628Z Test that a connection error during fetch returns the default content. ... ok
2025-07-31T07:38:11.8174559Z test_fetch_robots_txt_http_error_returns_default (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8200927Z Test that an HTTP error during fetch returns the default content. ... ok
2025-07-31T07:38:11.8202079Z test_fetch_robots_txt_success (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8222852Z Test successful fetching and returning of robots.txt content. ... ok
2025-07-31T07:38:11.8224007Z test_get_default_robots_txt (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8238389Z Test that the default robots.txt content is correct. ... ok
2025-07-31T07:38:11.8239377Z test_main_flow_in_cluster (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8299146Z Test the main execution logic when running inside a Kubernetes cluster. ... ok
2025-07-31T07:38:11.8299967Z test_main_flow_local_mode (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8372746Z Test the main execution logic when not in a cluster (local mode). ... ok
2025-07-31T07:38:11.8374500Z test_update_configmap_creates_new (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8415712Z Test that a new ConfigMap is created if it doesn't exist. ... ok
2025-07-31T07:38:11.8417535Z test_update_configmap_patches_existing (test.util.test_robots_fetcher.TestRobotsFetcherComprehensive)
2025-07-31T07:38:11.8456763Z Test that an existing ConfigMap is patched. ... ok
2025-07-31T07:38:11.8490449Z test_download_and_extract_crs (test.util.test_rules_fetcher.TestRulesFetcher) ... ok
2025-07-31T07:38:11.8499245Z test_fetch_rules_error (test.util.test_rules_fetcher.TestRulesFetcher) ... ERROR:src.util.rules_fetcher:Failed to fetch rules from http://example.com/rules: 
2025-07-31T07:38:11.8500662Z ok
2025-07-31T07:38:11.8516121Z test_fetch_rules_success (test.util.test_rules_fetcher.TestRulesFetcher) ... ok
2025-07-31T07:38:11.8540818Z test_main_flow_local (test.util.test_rules_fetcher.TestRulesFetcher) ... ok
2025-07-31T07:38:11.8562067Z test_update_configmap_patches_existing (test.util.test_rules_fetcher.TestRulesFetcher) ... ok
2025-07-31T07:38:11.8568680Z test_parse_eve_alerts (test.util.test_suricata_manager.TestSuricataManager) ... ok
2025-07-31T07:38:11.8575616Z test_process_eve_log_sends (test.util.test_suricata_manager.TestSuricataManager) ... ok
2025-07-31T07:38:11.8576782Z 
2025-07-31T07:38:11.8577132Z ======================================================================
2025-07-31T07:38:11.8577668Z ERROR: test.admin_ui.test_admin_ui (unittest.loader._FailedTest)
2025-07-31T07:38:11.8579809Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8581067Z ImportError: Failed to import test module: test.admin_ui.test_admin_ui
2025-07-31T07:38:11.8581799Z Traceback (most recent call last):
2025-07-31T07:38:11.8583306Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8584332Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8585404Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8586436Z     __import__(name)
2025-07-31T07:38:11.8587432Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/admin_ui/test_admin_ui.py", line 8, in <module>
2025-07-31T07:38:11.8588472Z     from src.admin_ui import admin_ui
2025-07-31T07:38:11.8589517Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/admin_ui/admin_ui.py", line 35, in <module>
2025-07-31T07:38:11.8590289Z     from src.shared.audit import log_event
2025-07-31T07:38:11.8590946Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/audit.py", line 7, in <module>
2025-07-31T07:38:11.8591595Z     os.makedirs(os.path.dirname(LOG_PATH), exist_ok=True)
2025-07-31T07:38:11.8592136Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8592538Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8592937Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8593555Z     mkdir(name, mode)
2025-07-31T07:38:11.8593800Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8594007Z 
2025-07-31T07:38:11.8594013Z 
2025-07-31T07:38:11.8594105Z ======================================================================
2025-07-31T07:38:11.8594442Z ERROR: test.ai_webhook.test_ai_webhook (unittest.loader._FailedTest)
2025-07-31T07:38:11.8594805Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8595185Z ImportError: Failed to import test module: test.ai_webhook.test_ai_webhook
2025-07-31T07:38:11.8595531Z Traceback (most recent call last):
2025-07-31T07:38:11.8596017Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8596491Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8597004Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8597473Z     __import__(name)
2025-07-31T07:38:11.8597946Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/ai_webhook/test_ai_webhook.py", line 5, in <module>
2025-07-31T07:38:11.8598455Z     from src.ai_service import ai_webhook
2025-07-31T07:38:11.8598951Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/ai_service/ai_webhook.py", line 110, in <module>
2025-07-31T07:38:11.8599439Z     os.makedirs(LOG_DIR, exist_ok=True)
2025-07-31T07:38:11.8599853Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8600246Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8600638Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8601013Z     mkdir(name, mode)
2025-07-31T07:38:11.8601246Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8601450Z 
2025-07-31T07:38:11.8601460Z 
2025-07-31T07:38:11.8601544Z ======================================================================
2025-07-31T07:38:11.8601900Z ERROR: test.escalation.test_escalation_engine (unittest.loader._FailedTest)
2025-07-31T07:38:11.8602283Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8602686Z ImportError: Failed to import test module: test.escalation.test_escalation_engine
2025-07-31T07:38:11.8603234Z Traceback (most recent call last):
2025-07-31T07:38:11.8603753Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8604435Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8605067Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8605526Z     __import__(name)
2025-07-31T07:38:11.8606027Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/escalation/test_escalation_engine.py", line 14, in <module>
2025-07-31T07:38:11.8606583Z     from src.escalation import escalation_engine
2025-07-31T07:38:11.8607132Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/escalation/escalation_engine.py", line 32, in <module>
2025-07-31T07:38:11.8607674Z     from src.shared.decision_db import record_decision
2025-07-31T07:38:11.8608202Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8608720Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8609171Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8609566Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8609951Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8610321Z     mkdir(name, mode)
2025-07-31T07:38:11.8610553Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8610756Z 
2025-07-31T07:38:11.8610761Z 
2025-07-31T07:38:11.8610845Z ======================================================================
2025-07-31T07:38:11.8611197Z ERROR: test.escalation.test_extract_features (unittest.loader._FailedTest)
2025-07-31T07:38:11.8611566Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8611956Z ImportError: Failed to import test module: test.escalation.test_extract_features
2025-07-31T07:38:11.8612314Z Traceback (most recent call last):
2025-07-31T07:38:11.8612779Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8613559Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8614071Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8614534Z     __import__(name)
2025-07-31T07:38:11.8615036Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/escalation/test_extract_features.py", line 5, in <module>
2025-07-31T07:38:11.8615591Z     from src.escalation import escalation_engine as ee
2025-07-31T07:38:11.8616156Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/escalation/escalation_engine.py", line 32, in <module>
2025-07-31T07:38:11.8616701Z     from src.shared.decision_db import record_decision
2025-07-31T07:38:11.8617223Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8617746Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8618193Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8618581Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8618977Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8619357Z     mkdir(name, mode)
2025-07-31T07:38:11.8619585Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8619786Z 
2025-07-31T07:38:11.8619790Z 
2025-07-31T07:38:11.8619881Z ======================================================================
2025-07-31T07:38:11.8620215Z ERROR: test.escalation.test_fingerprint (unittest.loader._FailedTest)
2025-07-31T07:38:11.8620587Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8620957Z ImportError: Failed to import test module: test.escalation.test_fingerprint
2025-07-31T07:38:11.8621506Z Traceback (most recent call last):
2025-07-31T07:38:11.8621992Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8622568Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8623310Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8623795Z     __import__(name)
2025-07-31T07:38:11.8624341Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/escalation/test_fingerprint.py", line 4, in <module>
2025-07-31T07:38:11.8624898Z     from src.escalation import escalation_engine as ee
2025-07-31T07:38:11.8625461Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/escalation/escalation_engine.py", line 32, in <module>
2025-07-31T07:38:11.8626005Z     from src.shared.decision_db import record_decision
2025-07-31T07:38:11.8626534Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8627061Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8627511Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8627901Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8628290Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8628663Z     mkdir(name, mode)
2025-07-31T07:38:11.8628888Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8629095Z 
2025-07-31T07:38:11.8629099Z 
2025-07-31T07:38:11.8629179Z ======================================================================
2025-07-31T07:38:11.8629538Z ERROR: test.escalation.test_frequency_features (unittest.loader._FailedTest)
2025-07-31T07:38:11.8629922Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8630321Z ImportError: Failed to import test module: test.escalation.test_frequency_features
2025-07-31T07:38:11.8630696Z Traceback (most recent call last):
2025-07-31T07:38:11.8631167Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8631635Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8632135Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8632599Z     __import__(name)
2025-07-31T07:38:11.8633358Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/escalation/test_frequency_features.py", line 4, in <module>
2025-07-31T07:38:11.8633969Z     from src.escalation import escalation_engine as ee
2025-07-31T07:38:11.8634539Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/escalation/escalation_engine.py", line 32, in <module>
2025-07-31T07:38:11.8635083Z     from src.shared.decision_db import record_decision
2025-07-31T07:38:11.8635613Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8636141Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8636590Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8636980Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8637383Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8637755Z     mkdir(name, mode)
2025-07-31T07:38:11.8637993Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8638198Z 
2025-07-31T07:38:11.8638202Z 
2025-07-31T07:38:11.8638293Z ======================================================================
2025-07-31T07:38:11.8638638Z ERROR: test.escalation.test_geoip_lookup (unittest.loader._FailedTest)
2025-07-31T07:38:11.8639005Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8639578Z ImportError: Failed to import test module: test.escalation.test_geoip_lookup
2025-07-31T07:38:11.8639933Z Traceback (most recent call last):
2025-07-31T07:38:11.8640518Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8640992Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8641506Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8641968Z     __import__(name)
2025-07-31T07:38:11.8642458Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/escalation/test_geoip_lookup.py", line 4, in <module>
2025-07-31T07:38:11.8643007Z     from src.escalation import escalation_engine as ee
2025-07-31T07:38:11.8643873Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/escalation/escalation_engine.py", line 32, in <module>
2025-07-31T07:38:11.8644420Z     from src.shared.decision_db import record_decision
2025-07-31T07:38:11.8644958Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8645482Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8645928Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8646322Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8646711Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8647085Z     mkdir(name, mode)
2025-07-31T07:38:11.8647370Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8647570Z 
2025-07-31T07:38:11.8647575Z 
2025-07-31T07:38:11.8647660Z ======================================================================
2025-07-31T07:38:11.8647987Z ERROR: test.shared.test_decision_db (unittest.loader._FailedTest)
2025-07-31T07:38:11.8648332Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8648706Z ImportError: Failed to import test module: test.shared.test_decision_db
2025-07-31T07:38:11.8649048Z Traceback (most recent call last):
2025-07-31T07:38:11.8649509Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8649985Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8650503Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8650969Z     __import__(name)
2025-07-31T07:38:11.8651434Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_decision_db.py", line 8, in <module>
2025-07-31T07:38:11.8651944Z     from src.shared import decision_db
2025-07-31T07:38:11.8652426Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/decision_db.py", line 19, in <module>
2025-07-31T07:38:11.8652942Z     os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)
2025-07-31T07:38:11.8653627Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8654025Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8654419Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8654792Z     mkdir(name, mode)
2025-07-31T07:38:11.8655018Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8655225Z 
2025-07-31T07:38:11.8655230Z 
2025-07-31T07:38:11.8655312Z ======================================================================
2025-07-31T07:38:11.8655644Z ERROR: test.shared.test_honeypot_logger (unittest.loader._FailedTest)
2025-07-31T07:38:11.8656000Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8656383Z ImportError: Failed to import test module: test.shared.test_honeypot_logger
2025-07-31T07:38:11.8656725Z Traceback (most recent call last):
2025-07-31T07:38:11.8657335Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 436, in _find_test_path
2025-07-31T07:38:11.8657904Z     module = self._get_module_from_name(name)
2025-07-31T07:38:11.8658413Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8658879Z     __import__(name)
2025-07-31T07:38:11.8659355Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/shared/test_honeypot_logger.py", line 12, in <module>
2025-07-31T07:38:11.8659882Z     from src.shared import honeypot_logger
2025-07-31T07:38:11.8660396Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/honeypot_logger.py", line 15, in <module>
2025-07-31T07:38:11.8660946Z     os.makedirs(os.path.dirname(HONEYPOT_LOG_FILE), exist_ok=True)
2025-07-31T07:38:11.8661418Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8661816Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8662202Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8662582Z     mkdir(name, mode)
2025-07-31T07:38:11.8662806Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8663013Z 
2025-07-31T07:38:11.8663017Z 
2025-07-31T07:38:11.8663244Z ======================================================================
2025-07-31T07:38:11.8663526Z ERROR: test.tarpit (unittest.loader._FailedTest)
2025-07-31T07:38:11.8663815Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8664131Z ImportError: Failed to import test module: test.tarpit
2025-07-31T07:38:11.8664410Z Traceback (most recent call last):
2025-07-31T07:38:11.8664872Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 470, in _find_test_path
2025-07-31T07:38:11.8665351Z     package = self._get_module_from_name(name)
2025-07-31T07:38:11.8665870Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/unittest/loader.py", line 377, in _get_module_from_name
2025-07-31T07:38:11.8666358Z     __import__(name)
2025-07-31T07:38:11.8666791Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/test/tarpit/__init__.py", line 2, in <module>
2025-07-31T07:38:11.8667262Z     from src.tarpit import (
2025-07-31T07:38:11.8667720Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/tarpit/__init__.py", line 1, in <module>
2025-07-31T07:38:11.8668161Z     from . import (
2025-07-31T07:38:11.8668598Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/tarpit/tarpit_api.py", line 34, in <module>
2025-07-31T07:38:11.8669115Z     from shared.honeypot_logger import log_honeypot_hit
2025-07-31T07:38:11.8669671Z   File "/home/runner/work/ai-scraping-defense/ai-scraping-defense/src/shared/honeypot_logger.py", line 15, in <module>
2025-07-31T07:38:11.8670228Z     os.makedirs(os.path.dirname(HONEYPOT_LOG_FILE), exist_ok=True)
2025-07-31T07:38:11.8670708Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 215, in makedirs
2025-07-31T07:38:11.8671104Z     makedirs(head, exist_ok=exist_ok)
2025-07-31T07:38:11.8671494Z   File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/os.py", line 225, in makedirs
2025-07-31T07:38:11.8671868Z     mkdir(name, mode)
2025-07-31T07:38:11.8672101Z PermissionError: [Errno 13] Permission denied: '/app'
2025-07-31T07:38:11.8672453Z 
2025-07-31T07:38:11.8672461Z 
2025-07-31T07:38:11.8672649Z ----------------------------------------------------------------------
2025-07-31T07:38:11.8673277Z Ran 96 tests in 5.783s
2025-07-31T07:38:11.8673428Z 
2025-07-31T07:38:11.8673504Z FAILED (errors=10)
2025-07-31T07:38:13.1528259Z Project root added to path: /home/runner/work/ai-scraping-defense/ai-scraping-defense
2025-07-31T07:38:13.1529547Z Discovering tests...
2025-07-31T07:38:13.1529974Z ----------------------------------------------------------------------
2025-07-31T07:38:13.1530845Z Imported 'user-agents'.
2025-07-31T07:38:13.1531194Z Imported 'xgboost'.
2025-07-31T07:38:13.1531565Z --- Starting Language Model Fine-Tuning ---
2025-07-31T07:38:13.1532313Z Loading tokenizer for base model: distilbert-base-uncased
2025-07-31T07:38:13.1533029Z Loading base model for sequence classification: distilbert-base-uncased
2025-07-31T07:38:13.1533946Z Starting model fine-tuning...
2025-07-31T07:38:13.1534350Z Fine-tuning finished in 0.00 seconds.
2025-07-31T07:38:13.1534973Z Best fine-tuned model and state saved to: /app/models/finetuned_bot_detector
2025-07-31T07:38:13.1535382Z 
2025-07-31T07:38:13.1535531Z Evaluating final best model on evaluation set...
2025-07-31T07:38:13.1535891Z --- Fine-Tuning Script Finished ---
2025-07-31T07:38:13.1536312Z Loading and preparing dataset from: /tmp/tmpstrwqzg2/data/train.jsonl
2025-07-31T07:38:13.1536765Z Dataset prepared. Number of examples: 3
2025-07-31T07:38:13.1537078Z Imported 'user-agents'.
2025-07-31T07:38:13.1537322Z Imported 'xgboost'.
2025-07-31T07:38:13.1537595Z Assigning labels and scores to the dataset...
2025-07-31T07:38:13.1537941Z Labeling complete. Label distribution:
2025-07-31T07:38:13.1538237Z label
2025-07-31T07:38:13.1538419Z bot      3
2025-07-31T07:38:13.1538612Z human    2
2025-07-31T07:38:13.1538815Z Name: count, dtype: int64
2025-07-31T07:38:13.1539073Z Imported 'user-agents'.
2025-07-31T07:38:13.1539308Z Imported 'xgboost'.
2025-07-31T07:38:13.1539589Z Loaded 2 IPs from /tmp/tmpgbd3dnfw/honeypot.log
2025-07-31T07:38:13.1539967Z Loaded 1 IPs from /tmp/tmpgbd3dnfw/captcha.log
2025-07-31T07:38:13.1540294Z Imported 'user-agents'.
2025-07-31T07:38:13.1540534Z Imported 'xgboost'.
2025-07-31T07:38:13.1540828Z Loaded 2 Disallow rules from /tmp/tmp7rzntehp/robots.txt
2025-07-31T07:38:13.1541196Z Imported 'user-agents'.
2025-07-31T07:38:13.1541429Z Imported 'xgboost'.
2025-07-31T07:38:13.1541654Z Imported 'user-agents'.
2025-07-31T07:38:13.1541883Z Imported 'xgboost'.
2025-07-31T07:38:13.1542023Z 
2025-07-31T07:38:13.1542120Z --- RF Model Evaluation ---
2025-07-31T07:38:13.1542382Z Accuracy: 1.0000
2025-07-31T07:38:13.1542516Z 
2025-07-31T07:38:13.1542617Z Classification Report:
2025-07-31T07:38:13.1542906Z                precision    recall  f1-score   support
2025-07-31T07:38:13.1543272Z 
2025-07-31T07:38:13.1543388Z        human       1.00      1.00      1.00         3
2025-07-31T07:38:13.1543710Z          bot       1.00      1.00      1.00         2
2025-07-31T07:38:13.1543921Z 
2025-07-31T07:38:13.1544035Z     accuracy                           1.00         5
2025-07-31T07:38:13.1544373Z    macro avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1544719Z weighted avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1544953Z 
2025-07-31T07:38:13.1545082Z Model saved to /tmp/tmp0gwa8of2/model.joblib
2025-07-31T07:38:13.1545312Z 
2025-07-31T07:38:13.1545420Z --- XGB Model Evaluation ---
2025-07-31T07:38:13.1545677Z Accuracy: 1.0000
2025-07-31T07:38:13.1545812Z 
2025-07-31T07:38:13.1545887Z Classification Report:
2025-07-31T07:38:13.1546103Z                precision    recall  f1-score   support
2025-07-31T07:38:13.1546278Z 
2025-07-31T07:38:13.1546365Z        human       1.00      1.00      1.00         3
2025-07-31T07:38:13.1546600Z          bot       1.00      1.00      1.00         2
2025-07-31T07:38:13.1546753Z 
2025-07-31T07:38:13.1546843Z     accuracy                           1.00         5
2025-07-31T07:38:13.1547103Z    macro avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1547361Z weighted avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1547543Z 
2025-07-31T07:38:13.1547644Z Model saved to /tmp/tmp0gwa8of2/model.joblib
2025-07-31T07:38:13.1547823Z 
2025-07-31T07:38:13.1547907Z --- LR Model Evaluation ---
2025-07-31T07:38:13.1548099Z Accuracy: 1.0000
2025-07-31T07:38:13.1548199Z 
2025-07-31T07:38:13.1548278Z Classification Report:
2025-07-31T07:38:13.1548487Z                precision    recall  f1-score   support
2025-07-31T07:38:13.1548663Z 
2025-07-31T07:38:13.1549072Z        human       1.00      1.00      1.00         3
2025-07-31T07:38:13.1549475Z          bot       1.00      1.00      1.00         2
2025-07-31T07:38:13.1549784Z 
2025-07-31T07:38:13.1549875Z     accuracy                           1.00         5
2025-07-31T07:38:13.1550138Z    macro avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1550397Z weighted avg       1.00      1.00      1.00         5
2025-07-31T07:38:13.1550576Z 
2025-07-31T07:38:13.1550676Z Model saved to /tmp/tmp0gwa8of2/model.joblib
2025-07-31T07:38:13.1550922Z Imported 'user-agents'.
2025-07-31T07:38:13.1551115Z Imported 'xgboost'.
2025-07-31T07:38:13.1551327Z Preparing and saving data for LLM fine-tuning...
2025-07-31T07:38:13.1551675Z Saved 2 records for fine-tuning to: /tmp/tmps0rsoqwl/ft_train.jsonl
2025-07-31T07:38:13.1552065Z Saved 0 records for fine-tuning to: /tmp/tmps0rsoqwl/ft_eval.jsonl
2025-07-31T07:38:13.1552368Z Imported 'user-agents'.
2025-07-31T07:38:13.1552559Z Imported 'xgboost'.
2025-07-31T07:38:13.1552670Z 
2025-07-31T07:38:13.1552749Z --- RF Model Evaluation ---
2025-07-31T07:38:13.1553440Z Skipping evaluation due to error: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2025-07-31T07:38:13.1554050Z Model saved to /tmp/tmp039wwnbw/model.joblib
2025-07-31T07:38:13.1554228Z 
2025-07-31T07:38:13.1554330Z --- Fetched Robots.txt Content ---
2025-07-31T07:38:13.1554540Z local content
2025-07-31T07:38:13.1554701Z Coverage Summary:
2025-07-31T07:38:13.1554899Z Name                                           Stmts   Miss  Cover
2025-07-31T07:38:13.1555190Z ------------------------------------------------------------------
2025-07-31T07:38:13.1555519Z src/admin_ui/__init__.py                           0      0   100%
2025-07-31T07:38:13.1555867Z src/admin_ui/admin_ui.py                         275    275     0%
2025-07-31T07:38:13.1556207Z src/ai_service/__init__.py                         0      0   100%
2025-07-31T07:38:13.1556542Z src/ai_service/ai_webhook.py                     340    340     0%
2025-07-31T07:38:13.1556888Z src/behavioral/__init__.py                         2      2     0%
2025-07-31T07:38:13.1557243Z src/behavioral/honeypot.py                        39     39     0%
2025-07-31T07:38:13.1557594Z src/bot_control/__init__.py                        3      3     0%
2025-07-31T07:38:13.1557935Z src/bot_control/crawler_auth.py                   14     14     0%
2025-07-31T07:38:13.1558278Z src/bot_control/pricing.py                        13     13     0%
2025-07-31T07:38:13.1558616Z src/captcha/__init__.py                            0      0   100%
2025-07-31T07:38:13.1558963Z src/captcha/custom_captcha_service.py             75     75     0%
2025-07-31T07:38:13.1559339Z src/captcha/recaptcha_service.py                  35     35     0%
2025-07-31T07:38:13.1559697Z src/cloud_dashboard/__init__.py                    0      0   100%
2025-07-31T07:38:13.1560057Z src/cloud_dashboard/cloud_dashboard_api.py        46      6    87%
2025-07-31T07:38:13.1560424Z src/config_recommender/__init__.py                 0      0   100%
2025-07-31T07:38:13.1560782Z src/config_recommender/recommender_api.py         48     48     0%
2025-07-31T07:38:13.1561144Z src/escalation/__init__.py                         0      0   100%
2025-07-31T07:38:13.1561501Z src/escalation/escalation_engine.py              786    786     0%
2025-07-31T07:38:13.1561856Z src/iis_gateway/__init__.py                        0      0   100%
2025-07-31T07:38:13.1562184Z src/iis_gateway/main.py                           78     78     0%
2025-07-31T07:38:13.1562520Z src/pay_per_crawl/__init__.py                      4      4     0%
2025-07-31T07:38:13.1562851Z src/pay_per_crawl/db.py                           41     41     0%
2025-07-31T07:38:13.1563284Z src/pay_per_crawl/payment_gateway.py             106    106     0%
2025-07-31T07:38:13.1563635Z src/pay_per_crawl/pricing.py                      16     16     0%
2025-07-31T07:38:13.1563971Z src/pay_per_crawl/proxy.py                        51     51     0%
2025-07-31T07:38:13.1564434Z src/plugins/__init__.py                           26     26     0%
2025-07-31T07:38:13.1564869Z src/public_blocklist/__init__.py                   0      0   100%
2025-07-31T07:38:13.1565234Z src/public_blocklist/public_blocklist_api.py      40      5    88%
2025-07-31T07:38:13.1565578Z src/rag/__init__.py                                3      3     0%
2025-07-31T07:38:13.1565906Z src/rag/email_entropy_scanner.py                  52     16    69%
2025-07-31T07:38:13.1566250Z src/rag/finetune.py                              142     68    52%
2025-07-31T07:38:13.1566576Z src/rag/training.py                              341    131    62%
2025-07-31T07:38:13.1566905Z src/security/__init__.py                           4      4     0%
2025-07-31T07:38:13.1567247Z src/security/attack_score.py                      12     12     0%
2025-07-31T07:38:13.1567606Z src/security/risk_scoring.py                      16     16     0%
2025-07-31T07:38:13.1567989Z src/security/sequence_anomaly.py                  46     46     0%
2025-07-31T07:38:13.1568344Z src/shared/__init__.py                             0      0   100%
2025-07-31T07:38:13.1568702Z src/shared/anomaly_detector.py                    32     14    56%
2025-07-31T07:38:13.1569050Z src/shared/audit.py                               18     18     0%
2025-07-31T07:38:13.1569389Z src/shared/config.py                             134      8    94%
2025-07-31T07:38:13.1569733Z src/shared/decision_db.py                         20     20     0%
2025-07-31T07:38:13.1570084Z src/shared/honeypot_logger.py                     29     29     0%
2025-07-31T07:38:13.1570434Z src/shared/metrics.py                            121     16    87%
2025-07-31T07:38:13.1570778Z src/shared/model_adapters.py                     289    258    11%
2025-07-31T07:38:13.1571139Z src/shared/model_provider.py                      41     15    63%
2025-07-31T07:38:13.1571490Z src/shared/redis_client.py                        35     16    54%
2025-07-31T07:38:13.1571832Z src/tarpit/__init__.py                             6      6     0%
2025-07-31T07:38:13.1572173Z src/tarpit/bad_api_generator.py                   39     39     0%
2025-07-31T07:38:13.1572530Z src/tarpit/ip_flagger.py                          59     59     0%
2025-07-31T07:38:13.1572881Z src/tarpit/js_zip_generator.py                    94     94     0%
2025-07-31T07:38:13.1573408Z src/tarpit/labyrinth.py                           19     19     0%
2025-07-31T07:38:13.1573766Z src/tarpit/markov_generator.py                   247    247     0%
2025-07-31T07:38:13.1574121Z src/tarpit/obfuscation.py                         18     18     0%
2025-07-31T07:38:13.1574480Z src/tarpit/rotating_archive.py                    51     51     0%
2025-07-31T07:38:13.1574834Z src/tarpit/tarpit_api.py                         230    230     0%
2025-07-31T07:38:13.1575158Z src/util/__init__.py                               9      9     0%
2025-07-31T07:38:13.1575491Z src/util/adaptive_rate_limit.py                   12      3    75%
2025-07-31T07:38:13.1575853Z src/util/adaptive_rate_limit_manager.py           41     20    51%
2025-07-31T07:38:13.1576210Z src/util/cdn_manager.py                           21     21     0%
2025-07-31T07:38:13.1576553Z src/util/community_blocklist_sync.py              55     27    51%
2025-07-31T07:38:13.1576925Z src/util/corpus_wikipedia_updater.py              72     35    51%
2025-07-31T07:38:13.1577287Z src/util/ddos_protection.py                       34     34     0%
2025-07-31T07:38:13.1577635Z src/util/peer_blocklist_sync.py                   55     23    58%
2025-07-31T07:38:13.1577986Z src/util/robots_fetcher.py                        87     48    45%
2025-07-31T07:38:13.1578330Z src/util/rules_fetcher.py                        130     80    38%
2025-07-31T07:38:13.1578681Z src/util/suricata_manager.py                      42     25    40%
2025-07-31T07:38:13.1579021Z src/util/tls_manager.py                           13     13     0%
2025-07-31T07:38:13.1579357Z src/util/waf_manager.py                           34     34     0%
2025-07-31T07:38:13.1579790Z ------------------------------------------------------------------
2025-07-31T07:38:13.1580170Z TOTAL                                           4741   3788    20%
2025-07-31T07:38:13.1580462Z ----------------------------------------------------------------------
2025-07-31T07:38:13.1580728Z Test suite failed.
2025-07-31T07:38:13.9840248Z ##[error]Process completed with exit code 1.
