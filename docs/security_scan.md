# Security Scan Helper

`scripts/linux/security_scan.sh` runs a collection of open-source tools to audit a target for common weaknesses. It invokes scanners such as **Nmap**, **Nikto**, **OWASP ZAP**, and **Trivy** alongside optional checks like **SQLMap**, **Bandit**, API security tests, and LLM prompt-injection exercises.

## Prerequisites
- Linux environment with the required utilities installed (e.g. `nmap`, `nikto`, `zaproxy`, `trivy`, `sqlmap`, `masscan`, `bandit`, etc.)
- Many scans need elevated privileges; run the script with `sudo`.
- Optionally install Docker if container images will be scanned.

## Legal Considerations
Only run the script against systems you own or have explicit permission to test. Unauthorized scanning can be illegal and may violate service agreements. Always consult local laws and organizational policies before performing any security tests.

## System Defenses
The AI Scraping Defense stack includes multiple layers designed to detect or mitigate the scanning techniques used by `scripts/linux/security_scan.sh`:

- **Nginx/Lua Filtering** – Blocks known bad user agents and IPs before heavy scanners like *Nikto* or *ZAP* can probe the site.
- **Rate Limit Daemon** – Throttles traffic spikes from tools such as *ffuf*, *wfuzz*, or *masscan*.
- **ModSecurity WAF** – When enabled via `ENABLE_WAF`, ModSecurity rules inspect requests for patterns generated by *SQLMap*, *wpscan*, and similar utilities.
- **Fail2ban Integration** – Repeated suspicious behavior from port sweeps or brute-force attempts triggers firewall bans.
- **Tarpit APIs** – Malicious scanners can be redirected to slow or fake endpoints, wasting their resources.
- **Comprehensive Logging** – All requests are logged and exported to Prometheus/Grafana for monitoring unusual activity.

Both `scripts/linux/security_scan.sh` and the new **`scripts/windows/security_scan.ps1`** script produce reports in the `reports` directory, allowing you to verify that these defenses are functioning as expected.

Static configuration checks validate against `config/security_hardening.yaml` to
ensure baseline hardening expectations are met in `docker-compose.yaml`.

Some tools require extra prerequisites: Go for ProjectDiscovery utilities
(`nuclei`, `katana`, `httpx`, `amass`, `dalfox`), Node.js for `snyk`, and
wordlists such as Seclists/DirBuster for directory and parameter fuzzing.

## Optional Deep-Dive Arguments

The scan script accepts optional parameters to trigger deeper API and LLM checks:

```bash
sudo ./scripts/linux/security_scan.sh <target> [web_url] [docker_image] [code_dir] [sqlmap_url] \
  [api_base_url] [openapi_spec_url] [llm_endpoint] [llm_auth_token]
```

- Use `api_base_url` to run `api_security_test` against the API surface.
- Use `llm_endpoint` to run the prompt-injection tests against the AI endpoint.
