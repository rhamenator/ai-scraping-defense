name: Security Autofix (queued)
on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Target environment (staging|production|preview)"
        required: false
      ref:
        description: "Git ref to run against"
        required: false
  workflow_call:
    inputs:
      environment:
        type: string
        required: false
      ref:
        type: string
        required: false
permissions:
  contents: write
  pull-requests: write
  issues: write
concurrency:
  group: ${{ github.workflow }}-${{ inputs.environment }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  autofix:
    uses: ./.github/workflows/autofix-and-guard.yml
    with:
      category: security
      pr_title: Automated security/style fixes
      automerge: true
