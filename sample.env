# sample.env
#
# Copy this file to .env and fill in your actual values.
# This file is used by 'docker-compose.yaml' for local development.
# IMPORTANT: Add .env to your .gitignore file to keep secrets out of version control!

# --- General Configuration ---
LOG_LEVEL=INFO
FLASK_ENV=development
DEBUG=true
# Include error "details" fields in HTTP responses (recommended: keep false in production).
ERROR_INCLUDE_DETAILS=false
TENANT_ID=default
# Deployment environment (e.g. production or development)
APP_ENV=production
# Number of worker processes for API services
UVICORN_WORKERS=2

# --- Model Configuration ---
# The primary URI to select the model and adapter.
# Use the format: <adapter_name>://<model_name_or_path>
# Examples:
# MODEL_URI=sklearn:///app/models/bot_detection_rf_model.joblib
# MODEL_URI=openai://gpt-4-turbo
# MODEL_URI=mistral://mistral-large-latest
# MODEL_URI=ollama://llama3
MODEL_URI=sklearn:///app/models/bot_detection_rf_model.joblib
# Optional explicit model type override
MODEL_TYPE=

# --- Service Ports (Defaults are usually fine for local testing) ---
# For production deployments you will typically expose the proxy
# on the standard HTTP/HTTPS ports. Set these to 80 and 443
# when deploying to a public-facing environment.
# Use standard ports for a production deployment
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
APACHE_HTTP_PORT=8080
AI_SERVICE_PORT=8000
TARPIT_API_PORT=8001
# Delay settings for tarpit responses
TAR_PIT_MIN_DELAY_SEC=0.6
TAR_PIT_MAX_DELAY_SEC=1.2
# Alternate variable names for compatibility
TAR_PIT_MAX_HOPS=250
TAR_PIT_HOP_WINDOW_SECONDS=86400
BLOCKLIST_TTL_SECONDS=86400
ENABLE_TARPIT_CATCH_ALL=true
ADMIN_UI_PORT=5002
# Admin UI CORS configuration (comma-separated values)
# ADMIN_UI_CORS_ORIGINS=http://localhost
# ADMIN_UI_CORS_METHODS=GET,POST,OPTIONS
# ADMIN_UI_CORS_HEADERS=Authorization,Content-Type,X-Requested-With,X-CSRF-Token
CLOUD_DASHBOARD_PORT=5006
CONFIG_RECOMMENDER_PORT=8010
PROMPT_ROUTER_PORT=8009
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
WATCHTOWER_INTERVAL=60
ESCALATION_ENGINE_PORT=8003
PG_PORT=5432
REDIS_PORT=6379
REDIS_DB_BLOCKLIST=2
REDIS_DB_TAR_PIT_HOPS=4
REDIS_DB_FREQUENCY=3
REDIS_DB_FINGERPRINTS=5
ALERT_SMTP_PORT=1025
ALERT_SMTP_WEB_PORT=8025

# --- Service Hosts ---
AI_SERVICE_HOST=ai_service
ESCALATION_ENGINE_HOST=escalation_engine
TARPIT_API_HOST=tarpit_api
ADMIN_UI_HOST=admin_ui
CLOUD_DASHBOARD_HOST=cloud_dashboard
CONFIG_RECOMMENDER_HOST=config_recommender
PROMPT_ROUTER_HOST=prompt_router
REDIS_HOST=redis
# Default SMTP host for alerts
ALERT_SMTP_HOST=mailhog

# Destination for allowed traffic from the proxy
# Optional comma-separated list of backend servers for simple load balancing
# If set, this overrides REAL_BACKEND_HOST
REAL_BACKEND_HOSTS=http://localhost:8082
# Fallback single backend host when REAL_BACKEND_HOSTS is empty
REAL_BACKEND_HOST=http://localhost:8082

# --- Alert SMTP Configuration ---
ALERT_SMTP_USE_TLS=false
ALERT_SMTP_USER=
ALERT_SMTP_PASSWORD_FILE=/run/secrets/smtp_password.txt
ALERT_METHOD=none
ALERT_GENERIC_WEBHOOK_URL=
ALERT_GENERIC_WEBHOOK_URL_FILE=
ALERT_SLACK_WEBHOOK_URL=
ALERT_SLACK_WEBHOOK_URL_FILE=
ALERT_EMAIL_TO=
ALERT_MIN_REASON_SEVERITY=Local LLM
ENABLE_COMMUNITY_REPORTING=true
COMMUNITY_BLOCKLIST_REPORT_URL=
COMMUNITY_BLOCKLIST_API_KEY_FILE=/run/secrets/community_blocklist_api_key
COMMUNITY_BLOCKLIST_REPORT_TIMEOUT=10.0
WEBHOOK_SHARED_SECRET=
WEBHOOK_RATE_LIMIT_REQUESTS=60
WEBHOOK_RATE_LIMIT_WINDOW=60

# --- Local Secrets (Copy from scripts/linux/generate_secrets.sh output or use your own) ---
# It's recommended to run ./scripts/linux/generate_secrets.sh and copy the output here.
PG_HOST=postgres
PG_DBNAME=markov_db
PG_USER=postgres
PG_PASSWORD_FILE=/run/secrets/pg_password.txt
REDIS_PASSWORD_FILE=/run/secrets/redis_password.txt
# Optional: set a preferred admin username; secret scripts generate one if blank.
ADMIN_UI_USERNAME=
# Required: set a strong bcrypt hash; service will fail if unset
# Generate with: python -c "import bcrypt; print(bcrypt.hashpw(b'new_password', bcrypt.gensalt()).decode())"
# Required: Replace with a strong bcrypt hash before deployment!
ADMIN_UI_PASSWORD_HASH=
# Optional base32 secret to enable 2FA for the Admin UI
ADMIN_UI_2FA_SECRET=
SYSTEM_SEED=

# --- HashiCorp Vault Configuration ---
# Enable Vault integration for secret management
VAULT_ADDR=http://vault:8200
VAULT_TOKEN=
VAULT_NAMESPACE=
# AppRole authentication (alternative to token)
VAULT_ROLE_ID=
VAULT_SECRET_ID=
# Kubernetes authentication (for K8s deployments)
VAULT_KUBERNETES_ROLE=
VAULT_KUBERNETES_JWT_PATH=/var/run/secrets/kubernetes.io/serviceaccount/token
# Vault configuration
VAULT_MOUNT_POINT=secret
VAULT_VERIFY_TLS=true
VAULT_TIMEOUT=30

# --- LLM & External Service API Keys ---
# Fill these in if you want to use a specific LLM provider.
# The model adapters will look for these specific environment variable names.
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GOOGLE_API_KEY=
COHERE_API_KEY=
MISTRAL_API_KEY=
# Local LLM inference settings
LOCAL_LLM_API_URL=
LOCAL_LLM_MODEL=
LOCAL_LLM_TIMEOUT=45.0

# --- Model Context Protocol Settings ---
# Example configuration for an MCP server labelled "PRIMARY"
# Set MODEL_URI=mcp://primary/<tool_name> to invoke it.
MCP_SERVER_PRIMARY_TRANSPORT=ws
MCP_SERVER_PRIMARY_URL=ws://localhost:8085/mcp
MCP_SERVER_PRIMARY_AUTH_TOKEN=
# Optional JSON structures for extra headers or environment variables
MCP_SERVER_PRIMARY_HEADERS_JSON={}
MCP_SERVER_PRIMARY_ENV_JSON={}
MCP_SERVER_PRIMARY_TIMEOUT=30

# Generic key for other external services
EXTERNAL_API_KEY=
IP_REPUTATION_API_KEY=
COMMUNITY_BLOCKLIST_API_KEY=
EXTERNAL_CLASSIFICATION_API_KEY_FILE=/run/secrets/external_api_key
EXTERNAL_CLASSIFICATION_API_URL=
IP_REPUTATION_API_KEY_FILE=/run/secrets/ip_reputation_api_key
ENABLE_IP_REPUTATION=false
# API key used to authorize submissions to the public community blocklist
PUBLIC_BLOCKLIST_API_KEY=
# File path for storing IPs in the public community blocklist service
PUBLIC_BLOCKLIST_FILE=./data/public_blocklist.json
# Additional service endpoints
EXTERNAL_API_URL=http://mock_external_api:8000
IP_REPUTATION_API_URL=http://mock_ip_reputation_api:8000
IP_REPUTATION_TIMEOUT=10.0
IP_REPUTATION_MALICIOUS_SCORE_BONUS=0.3
IP_REPUTATION_MIN_MALICIOUS_THRESHOLD=50
EXTERNAL_API_TIMEOUT=15.0
# Base URL for the community blocklist sync service
# Default: https://mock_community_blocklist_api:8000
COMMUNITY_BLOCKLIST_API_URL=
# Endpoint path for fetching the blocklist (usually '/list')
COMMUNITY_BLOCKLIST_LIST_ENDPOINT=/list
# Interval in seconds between sync runs
COMMUNITY_BLOCKLIST_SYNC_INTERVAL=3600
# TTL for blocklist entries pulled from the community feed
COMMUNITY_BLOCKLIST_TTL_SECONDS=86400
# Comma-separated list of peer blocklist URLs for federated sharing
PEER_BLOCKLIST_URLS=
# Interval in seconds between peer sync runs
PEER_BLOCKLIST_SYNC_INTERVAL=3600
# TTL for entries pulled from peers
PEER_BLOCKLIST_TTL_SECONDS=86400

# CAPTCHA configuration
CAPTCHA_SECRET=
CAPTCHA_SECRET_FILE=
ENABLE_CAPTCHA_TRIGGER=false
CAPTCHA_SCORE_THRESHOLD_LOW=0.2
CAPTCHA_SCORE_THRESHOLD_HIGH=0.5
CAPTCHA_VERIFICATION_URL=
CAPTCHA_TOKEN_EXPIRY_SECONDS=300

# --- Optional Cloud Features ---
ENABLE_GLOBAL_CDN=false
CLOUD_CDN_PROVIDER=cloudflare
CLOUD_CDN_API_TOKEN=

ENABLE_DDOS_PROTECTION=true
DDOS_PROTECTION_PROVIDER_URL=
DDOS_PROTECTION_API_KEY=

ENABLE_MANAGED_TLS=true
TLS_PROVIDER=certbot
TLS_EMAIL=

# --- GDPR Compliance Configuration ---
# Enable GDPR compliance framework
GDPR_ENABLED=true
# Data Protection Officer (DPO) contact information
GDPR_DPO_NAME=Data Protection Officer
GDPR_DPO_EMAIL=dpo@example.com
GDPR_DPO_PHONE=
# Data retention period in days (default: 365)
GDPR_DATA_RETENTION_DAYS=365
# Require explicit user consent for non-essential data processing
GDPR_CONSENT_REQUIRED=true
# GDPR audit log file path
GDPR_AUDIT_LOG_FILE=/app/logs/gdpr_audit.log

# --- Local TLS Configuration ---
ENABLE_HTTPS=false
# Optional: avoid Host-header based redirects by setting a canonical host or allowlist.
# SECURITY_HTTPS_REDIRECT_CANONICAL_HOST=example.com
# SECURITY_HTTPS_REDIRECT_ALLOWED_HOSTS=example.com,example.com:8443
TLS_CERT_PATH=./nginx/certs/tls.crt
TLS_KEY_PATH=./nginx/certs/tls.key

# Optional request-target limits (defense-in-depth; 0 disables a check).
# SECURITY_MAX_PATH_LENGTH=2048
# SECURITY_MAX_QUERY_STRING_LENGTH=4096
# SECURITY_MAX_HEADER_COUNT=100
# SECURITY_MAX_HEADER_VALUE_LENGTH=8192

ENABLE_WAF=true
WAF_RULES_PATH=/etc/nginx/waf_rules.conf
# URL to download custom WAF rules (must use HTTPS)
RULES_DOWNLOAD_URL=https://example.com/custom.rules
# Optional comma-separated list of allowed domains for rule downloads
RULES_ALLOWED_DOMAINS=example.com

# --- Adaptive Rate Limiting ---
BASE_RATE_LIMIT=60
ADAPTIVE_RATE_WINDOW_SECONDS=60
ADAPTIVE_RATE_LIMIT_INTERVAL=60
NGINX_RATE_LIMIT_CONF=/etc/nginx/conf.d/req_rate_limit.conf

# --- Tarpit Text Generation ---
DEFAULT_SENTENCES_PER_PAGE=15
FAKE_LINK_COUNT=7
FAKE_LINK_DEPTH=3
ENABLE_TARPIT_LLM_GENERATOR=false
TARPIT_LLM_MODEL_URI=
TARPIT_LLM_MAX_TOKENS=400
ENABLE_AI_LABYRINTH=true
ENABLE_FINGERPRINTING=true

# Request fingerprinting windows
FREQUENCY_WINDOW_SECONDS=300
FINGERPRINT_WINDOW_SECONDS=604800
FINGERPRINT_REUSE_THRESHOLD=3

# --- Anomaly Detection ---
# Optional isolation forest or other anomaly detection model
# Example: ANOMALY_MODEL_PATH=./models/anomaly_iforest.joblib
ANOMALY_MODEL_PATH=
ANOMALY_THRESHOLD=0.7

# --- Plugin System ---
ENABLE_PLUGINS=true

# --- Escalation Engine Configuration ---
ESCALATION_THRESHOLD=0.8
# API key required to access escalation engine endpoints
ESCALATION_API_KEY=
ESCALATION_WEBHOOK_URL=
# Comma-separated domains allowed for webhook URL
ESCALATION_WEBHOOK_ALLOWED_DOMAINS=
# --- Cybersecurity Partnerships ---
PARTNER_THREAT_FEED_URL=
PARTNER_THREAT_FEED_API_KEY=
PARTNER_ALERT_WEBHOOK=

# --- API Authentication (JWT) ---
# JWT verification settings used by internal services (e.g. escalation engine).
# For HS* algorithms, provide AUTH_JWT_SECRET or AUTH_JWT_SECRET_FILE.
# For RS*/ES*/EdDSA algorithms, provide AUTH_JWT_PUBLIC_KEY or AUTH_JWT_PUBLIC_KEY_FILE
# (AUTH_JWT_SECRET may also be used if it contains PEM key material).
# Secret for signing/verifying HS256 JWTs used by internal services
AUTH_JWT_SECRET=
# Optional: secret file containing the JWT secret
AUTH_JWT_SECRET_FILE=
# Optional: public key for verifying RS*/ES*/EdDSA tokens
AUTH_JWT_PUBLIC_KEY=
# Optional: public key file for verifying RS*/ES*/EdDSA tokens
AUTH_JWT_PUBLIC_KEY_FILE=
# Comma-separated list of allowed JWT algorithms
AUTH_JWT_ALGORITHMS=HS256
# Optional: expected issuer and audience claims
AUTH_JWT_ISSUER=
AUTH_JWT_AUDIENCE=
