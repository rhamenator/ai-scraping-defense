# kubernetes/service-accounts.yaml
# Service accounts for all services following least privilege principle
# Following CIS Benchmark 5.1 - RBAC and Service Accounts

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: nginx-proxy-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: redis-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: postgres-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: escalation-engine-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tarpit-api-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: ai-service-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-ui-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: fail2ban-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: suricata-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: archive-rotator-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: markov-model-trainer-sa
  namespace: ai-defense
automountServiceAccountToken: false

---
# Note: CronJob service accounts (waf-rules-updater-sa, configmap-editor-sa)
# are already defined in their respective RBAC files and need API access
